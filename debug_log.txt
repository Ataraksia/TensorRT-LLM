Using LogitsProcessor-based + post-processing delay pattern implementation
_fill_output called, result type: <class 'torch.Tensor'>
Result is tensor directly
output_ids_to_process type: <class 'torch.Tensor'>, shape: torch.Size([1, 1, 2048])
output_ids_list length: 1
First sequence length: 2048
First 20 tokens: [128000, 128000, 128006, 9125, 128007, 271, 32215, 7855, 2768, 7754, 13, 128018, 15097, 374, 12715, 505, 264, 11594, 3130, 815]
Found audio_out_bos positions: [72]
Context around audio_out_bos (pos 72): [128009, 128006, 78191, 128007, 271, 128013, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 645, 2980, 2980, 996, 594, 2980, 2980, 996, 1874, 2980, 996, 996, 7530, 996, 2980, 996, 795, 2462, 2980, 996, 5662, 2980, 2799, 190, 645, 2158, 645, 1741, 5807, 95, 645, 996, 5424, 7923, 2980, 1115, 7449, 996, 7687, 697, 95]
Audio generation stopped at position 82 with non-audio token: 2980
Collected 9 audio tokens
Raw audio tokens (first 50): [1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 645]
Original frames shape: torch.Size([2, 8])
Post-vLLM-processing frames shape: torch.Size([2, 8])
Processed audio tokens (first 50): [1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 645, 1024, 1024, 1024, 1024, 1024, 1024, 1024]
